---
title: "Comments - what to"
author:
  - name: Søren O'Neill
    url: www.oneill.dk
date: '`r Sys.Date()`'
output:
  distill::distill_article:
    self_contained: false
#collections:
#  posts:
#    disqus: reproducible-finance-with-r
#categories:
#  - Installation
creative_commons: CC BY
format: html
editor: source
---

```{r include=FALSE}
#library(vembedr)
library(tidyverse)
library(ggplot2)
library(DiagrammeR)
```

# Kommentarer der giver _mening_

Hvilke kommentarer ville være relevante her?

::: panel-tabset

# Spørgsmål

Kom med forslag til kommentarer til denne kode ... tænk 'hvad' og 'hvorfor'

```{r eval=FALSE, echo=TRUE}
# 1
d <- read.csv("my_data_file.csv")

# 2
d <- d %>% filter(id != "241269-1212")

# 3
d <- d %>% 
  mutate(s=factor(c("M", "F"))[as.numeric(substr(id,nchar(id),nchar(id))) %% 2])

```


# Løsning

Forslag til meningsfyldte kommentarer

```{r eval=FALSE, echo=TRUE}
# ?? comments necessary ??
d <- read.csv("my_data_file.csv")

# excluded as participant entered an invalid CPR number
d <- d %>% filter(id != "2321369-1212")

# set 's' to F(emale) or M(ale) depending on odd/even id number in CPR
d <- d %>% 
  mutate(s=factor(c("F", "M"))[as.numeric(substr(id,nchar(id),nchar(id))) %% 2 + 1 ])

```
::::

::: {.callout-note collapse=true}
## Bemærkninger til løsningen

I forhold til de tre linjer kode i øvelsen herover:

1. unødvendigt med en kommentar til den første linje -- koden er selv-forklarende
2. en god ide med en kommentar til anden linje der forklarer _hvorfor_ man sletter det pågældende CPR nummer
3. en god iden med en kommentar til tredje linje derforklarer hvad koden _gør_ for det er ikke indlysende! 

Kode linje 3 er lidt kompliceret (med vilje) men kort fortalt: Den beregner en ny variable `s` som enten er 'M' eller 'F' for hhv ulige og lige CPR numre. Hvis du gerne vil forstå kode:

> Hvis `id` er en tekst-string for et CPR nummer, kigger koden to det sidste tegn (`substr(id,nchar(id),nchar(id))`), konverterer det til en talværdi (`as.numeric`) og beregner _modulus 2_ (`%% 2`), altså heltals-resten ved division med to (som bliver `0` for lige tal og `1` for ulige tal), så lægger den 1 til (`+1`) og bruger tallet (som altså nu er `1` for CPR numre med lige tal og `2` for CPR numre med ulige tal), og sætter `s` til index 1 eller 2 af faktoren `factor(c("F", "M"))` -- det fungerer fint, men det var ikke selv-indlysende, vel?. 
:::

## Kommentér din kode

**Hovedpointer**

* **Altid** føj kommentarer til din kode
* Kommentarer skulle forklare 'hvorfor' (dit rationale)
* Med god kode, bliver 'hvordan' selv-indlysende
    - ..men hvis din kode ikke kan være selv-indlysende: så forklar hvordan den fungerer i kommentarer


<script src="https://giscus.app/client.js"
        data-repo="sorenoneill/r4phd"
        data-repo-id="R_kgDOJ9etDQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOJ9etDc4CYApF"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="0"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="cobalt"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>