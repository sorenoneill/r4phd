---
title: "Comments - what to"
author:
  - name: SÃ¸ren O'Neill
    url: www.oneill.dk
date: '`r Sys.Date()`'
output:
  distill::distill_article:
    self_contained: false
#collections:
#  posts:
#    disqus: reproducible-finance-with-r
#categories:
#  - Installation
creative_commons: CC BY
format: html
editor: source
---

```{r include=FALSE}
#library(vembedr)
library(tidyverse)
library(ggplot2)
library(DiagrammeR)
```

# Meaningful comments

What comments would be relevant here?

::: panel-tabset

# Question

Suggest comments for this code... think 'what' and 'why'

```{r eval=FALSE, echo=TRUE}
# 1
d <- read.csv("my_data_file.csv")

# 2
d <- d %>% filter(id != "241269-1212")

# 3
d <- d %>% 
  mutate(s=factor(c("F", "M"))[as.numeric(substr(id,nchar(id),nchar(id))) %% 2 + 1 ])

```


# Solution

Suggestions for meaningful comments

```{r eval=FALSE, echo=TRUE}
# ?? comments necessary ??
d <- read.csv("my_data_file.csv")

# excluded as participant entered an invalid CPR number
d <- d %>% filter(id != "2321369-1212")

# set 's' to F(emale) or M(ale) depending on odd/even id number in CPR
d <- d %>% 
  mutate(s=factor(c("M", "F"))[as.numeric(substr(id,nchar(id),nchar(id))) %% 2])

```
::::

::: {.callout-note collapse=true}
## Notes for the solution

In relation to each of the three lines of code in the exercise above:

1. it is unnecessary to comment this line -- the code is self-explanatory
2. it's a good idea to comment line two to explain _why_ the CPR number in question was deleted.
3. it's a good idea to comment line three to explain _what_ the code does, as it is not self-explanatory! 

The code in line 3 is a little complicated (on purpose), but basically, it creates a new variable `s` which is either 'M' or 'F' for odd and even CPR numbers. If you want to understand the code:

> If `id` is a text string representation of a CPR number, the code evaluates the last character in the string (`substr(id,nchar(id),nchar(id))`), converts it into a numerical value (`as.numeric`) and calculates the _modulus 2_ (`%% 2`), i.e. the integer remainder of division by 2 (which becomes `0` for even numbers and `1` for odd numbers), it then adds 1 (`+1`) and uses that numbers (which is now `1` for even CPR numbers and `2` for odd CPR numbers), and sets `s` to be index 1 or 2 of the factor `factor(c("F", "M"))` -- this works just fine, but it is not self-explanatory, is it?
:::

## Commenting your code

**Main points**

* **Always** comment your code
* Comments should explain your thinking : 'why'
* With good code the 'how' is self-evident
    - ..but if your code can not be self-evident: explain in comments


<script src="https://giscus.app/client.js"
        data-repo="sorenoneill/r4phd"
        data-repo-id="R_kgDOJ9etDQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOJ9etDc4CYApF"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="0"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="cobalt"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>